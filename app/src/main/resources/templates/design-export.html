<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: "Microsoft YaHei", "SimSun", sans-serif; 
            color: #2c3e50;
            line-height: 1.8;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8ec 100%);
        }
        .page { 
            width: 210mm; 
            min-height: 297mm; 
            padding: 20mm;
            margin: 10px auto;
            background: white;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        .header {
            text-align: center;
            padding-bottom: 20px;
            border-bottom: 3px solid #8B4513;
            margin-bottom: 30px;
        }
        .header h1 {
            font-size: 32px;
            color: #8B4513;
            margin-bottom: 10px;
            letter-spacing: 4px;
        }
        .header .subtitle {
            font-size: 14px;
            color: #999;
            letter-spacing: 2px;
        }
        .product-image {
            text-align: center;
            margin: 20px 0;
            padding: 20px;
            background: linear-gradient(145deg, #fafafa, #f0f0f0);
            border-radius: 12px;
        }
        .product-image img {
            max-width: 70%;
            border-radius: 8px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        .image-caption {
            margin-top: 10px;
            font-size: 11px;
            color: #666;
        }
        .poster-table {
            width: 100%;
            border-collapse: collapse;
        }
        .poster-td {
            width: 100%;
            text-align: center;
            vertical-align: top;
            padding: 10px 0;
        }
        .poster-img {
            width: 100%;
            max-width: 165mm;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        .section {
            margin: 25px 0;
            padding: 20px;
            background: #fff;
            border-left: 4px solid #D4AF37;
            border-radius: 0 8px 8px 0;
        }
        .section-title {
            font-size: 18px;
            color: #8B4513;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid #eee;
        }
        .section-title span {
            color: #D4AF37;
            margin-right: 10px;
        }
        .section-content {
            font-size: 13px;
            color: #555;
            text-align: justify;
        }
        .highlight-box {
            background: linear-gradient(135deg, #FFF8E7 0%, #FFF0D0 100%);
            padding: 15px 20px;
            border-radius: 8px;
            margin: 10px 0;
            border: 1px solid #D4AF37;
        }
        /* Grid æ›¿æ¢ä¸º Table å¸ƒå±€ */
        .card-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 15px 15px;
            margin: 15px 0;
        }
        .card-td {
            width: 50%;
            background: linear-gradient(145deg, #f8f9fa, #e9ecef);
            padding: 15px;
            border-radius: 8px;
            border-left: 3px solid #8B4513;
            vertical-align: top;
        }
        .card-content {
            font-size: 11px;
            color: #666;
        }
        .color-list {
            /* ä½¿ç”¨ inline-block å¸ƒå±€ */
            margin: 15px 0;
        }
        .color-item {
            display: inline-block;
            text-align: center;
            margin-right: 15px;
            margin-bottom: 15px;
            vertical-align: top;
        }
        .color-swatch {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            margin-bottom: 5px;
            border: 3px solid white;
        }
        .color-name {
            font-size: 10px;
            color: #666;
        }
        .feature-list {
            list-style: none;
            padding: 0;
        }
        .feature-list li {
            padding: 8px 0 8px 25px;
            position: relative;
            font-size: 12px;
            border-bottom: 1px dashed #eee;
        }
        .feature-list li span.bullet {
            position: absolute;
            left: 0;
            color: #D4AF37;
            font-weight: bold;
        }
        .analysis-section {
            background: linear-gradient(135deg, #f8f9fa 0%, #e8f4f8 100%);
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
        }
        .analysis-title {
            font-size: 16px;
            color: #2A5B8C;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #2A5B8C;
        }
        /* Grid æ›¿æ¢ä¸º Table å¸ƒå±€ */
        .analysis-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 20px 10px;
        }
        .analysis-td {
            width: 50%;
            vertical-align: top;
        }
        /* Flex æ›¿æ¢ä¸º Table å¸ƒå±€ */
        .metric-table {
            width: 100%;
            background: white;
            border-radius: 6px;
            margin: 8px 0;
            border-collapse: collapse;
        }
        .metric-td {
            padding: 10px;
        }
        .metric-label {
            color: #666;
            font-size: 12px;
            text-align: left;
        }
        .metric-value {
            color: #8B4513;
            font-weight: bold;
            font-size: 12px;
            text-align: right;
        }
        .risk-section {
            background: #FFF5F5;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            border-left: 3px solid #E74C3C;
        }
        .risk-title {
            color: #E74C3C;
            font-size: 13px;
            font-weight: bold;
            margin-bottom: 8px;
        }
        .risk-content {
            font-size: 11px;
            color: #666;
        }
        .footer {
            text-align: center;
            padding-top: 20px;
            margin-top: 30px;
            border-top: 1px solid #eee;
            color: #999;
            font-size: 10px;
        }
        .brand {
            color: #8B4513;
            font-weight: bold;
        }
        @media print {
            .page { box-shadow: none; margin: 0; }
        }
    </style>
</head>
<body>
    <div class="page">
        <div class="header">
            <h1 th:text="${entity.designName}">è®¾è®¡åç§°</h1>
            <div class="subtitle">AI æ™ºèƒ½æ–‡åˆ›è®¾è®¡ææ¡ˆ Â· HERITAGE CULTURE</div>
        </div>

        <!-- äº§å“å›¾ç‰‡ -->
        <div class="product-image" th:if="${productShotSrc != null and !productShotSrc.isBlank()}">
            <img th:src="${productShotSrc}" alt="äº§å“æ•ˆæœå›¾" />
            <div class="image-caption">äº§å“æ•ˆæœå›¾ï¼ˆå®ç‰©å®šå¦†ï¼‰</div>
        </div>

        <!-- æ¦‚å¿µè‰å›¾ -->
        <div class="product-image" th:if="${blueprintSrc != null and !blueprintSrc.isBlank()}">
            <img th:src="${blueprintSrc}" alt="æ¦‚å¿µè‰å›¾" />
            <div class="image-caption">æ¦‚å¿µè‰å›¾ï¼ˆBlueprintï¼‰</div>
        </div>

        <!-- å•†ä¸šæµ·æŠ¥ï¼ˆKV / åœºæ™¯ / ç»†èŠ‚ï¼‰ -->
        <div class="section" th:if="${kvSrc != null or lifestyleSrc != null or detailSrc != null}">
            <div class="section-title"><span>â—†</span>å•†ä¸šè§†è§‰æµ·æŠ¥</div>
            <div class="section-content">
                <table class="poster-table">
                    <tr th:if="${kvSrc != null}">
                        <td class="poster-td">
                            <img class="poster-img" th:src="${kvSrc}" alt="å•†ä¸šKVæµ·æŠ¥" />
                            <div class="image-caption">æµ·æŠ¥01 - ä¸»KVè§†è§‰ï¼ˆKey Visualï¼‰</div>
                        </td>
                    </tr>
                    <tr th:if="${lifestyleSrc != null}">
                        <td class="poster-td">
                            <img class="poster-img" th:src="${lifestyleSrc}" alt="åœºæ™¯åº”ç”¨æµ·æŠ¥" />
                            <div class="image-caption">æµ·æŠ¥02 - ç”Ÿæ´»åœºæ™¯/ä½¿ç”¨åœºæ™¯ï¼ˆLifestyleï¼‰</div>
                        </td>
                    </tr>
                    <tr th:if="${detailSrc != null}">
                        <td class="poster-td">
                            <img class="poster-img" th:src="${detailSrc}" alt="å·¥è‰ºç»†èŠ‚æµ·æŠ¥" />
                            <div class="image-caption">æµ·æŠ¥03 - å·¥è‰º/æŠ€æœ¯/æ¦‚å¿µå¯è§†åŒ–ï¼ˆCraft Detailï¼‰</div>
                        </td>
                    </tr>
                </table>
            </div>
        </div>

        <!-- è®¾è®¡ç†å¿µ -->
        <div class="section" th:if="${entity.designConcept != null}">
            <div class="section-title"><span>â—†</span>è®¾è®¡ç†å¿µ</div>
            <div class="section-content highlight-box" th:text="${entity.designConcept}"></div>
        </div>

        <!-- æ–‡åŒ–æº¯æº -->
        <div class="section" th:if="${conceptData['culturalContext'] != null}">
            <div class="section-title"><span>â—†</span>æ–‡åŒ–æº¯æº</div>
            <div class="section-content" th:text="${conceptData['culturalContext']}"></div>
        </div>

        <!-- å½¢æ€è§„æ ¼ -->
        <div class="section" th:if="${conceptData['formFactor'] != null}">
            <div class="section-title"><span>â—†</span>å½¢æ€è§„æ ¼</div>
            <div class="section-content" th:text="${conceptData['formFactor']}"></div>
            <div class="highlight-box" style="margin-top:10px;" th:if="${conceptData['dimensions'] != null}" th:text="'ğŸ“ å°ºå¯¸ï¼š' + ${conceptData['dimensions']}"></div>
        </div>

        <!-- äº¤äº’ä½“éªŒ -->
        <div class="section" th:if="${conceptData['userInteraction'] != null}">
            <div class="section-title"><span>â—†</span>äº¤äº’ä½“éªŒ</div>
            <div class="section-content" th:text="${conceptData['userInteraction']}"></div>
        </div>

        <!-- æè´¨å·¥è‰º (Grid -> Table) -->
        <div class="section" th:if="${materialsList != null and !materialsList.isEmpty()}">
            <div class="section-title"><span>â—†</span>æè´¨å·¥è‰º</div>
            <table class="card-table">
                <!-- è¿™é‡Œçš„é€»è¾‘ç¨å¾®å¤æ‚ï¼Œéœ€è¦æ¯ä¸¤ä¸ªå…ƒç´ ä¸€è¡Œ -->
                <tr th:each="i : ${#numbers.sequence(0, materialsList.size() - 1, 2)}">
                    <td class="card-td">
                        <div class="card-content" th:text="${materialsList[i]}"></div>
                    </td>
                    <td class="card-td" th:if="${i + 1 < materialsList.size()}">
                        <div class="card-content" th:text="${materialsList[i + 1]}"></div>
                    </td>
                    <!-- è¡¥å…¨ç©ºå•å…ƒæ ¼ä»¥ä¿æŒæ ·å¼ä¸€è‡´ -->
                    <td class="card-td" th:if="${i + 1 >= materialsList.size()}" style="visibility: hidden;"></td>
                </tr>
            </table>
        </div>

        <!-- è‰²å½©æ–¹æ¡ˆ -->
        <div class="section" th:if="${colorsList != null and !colorsList.isEmpty()}">
            <div class="section-title"><span>â—†</span>è‰²å½©æ–¹æ¡ˆ</div>
            <div class="color-list">
                <div class="color-item" th:each="color : ${colorsList}">
                    <div class="color-swatch" th:style="'background:' + ${color.hex}"></div>
                    <div class="color-name" th:text="${color.name}"></div>
                </div>
            </div>
        </div>

        <!-- æ ¸å¿ƒåŠŸèƒ½ç‚¹ -->
        <div class="section" th:if="${featuresList != null and !featuresList.isEmpty()}">
            <div class="section-title"><span>â—†</span>æ ¸å¿ƒåŠŸèƒ½ç‚¹</div>
            <ul class="feature-list">
                <li th:each="feature : ${featuresList}">
                    <span class="bullet">âœ“</span>
                    <span th:text="${feature}"></span>
                </li>
            </ul>
        </div>

        <!-- å¸‚åœºåˆ†æ (Flex -> Table) -->
        <div class="analysis-section" th:if="${market != null}">
            <div class="analysis-title">ğŸ“Š å¸‚åœºåˆ†æä¸å•†ä¸šå®šä½</div>
            <table class="analysis-table">
                <tr>
                    <td class="analysis-td" th:if="${market['targetPersona'] != null}">
                        <table class="metric-table">
                            <tr>
                                <td class="metric-td metric-label">ç›®æ ‡å®¢ç¾¤</td>
                                <td class="metric-td metric-value" th:text="${#strings.length(market['targetPersona']) > 50 ? #strings.substring(market['targetPersona'], 0, 50) + '...' : market['targetPersona']}"></td>
                            </tr>
                        </table>
                    </td>
                    <td class="analysis-td" th:if="${market['priceRange'] != null}">
                        <table class="metric-table">
                            <tr>
                                <td class="metric-td metric-label">å®šä»·åŒºé—´</td>
                                <td class="metric-td metric-value" th:text="${market['priceRange']}"></td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td class="analysis-td" th:if="${market['marketPositioning'] != null}" colspan="2">
                        <table class="metric-table">
                            <tr>
                                <td class="metric-td metric-label">å¸‚åœºå®šä½</td>
                                <td class="metric-td metric-value" th:text="${market['marketPositioning']}"></td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
        </div>

        <!-- æŠ€æœ¯å¯è¡Œæ€§ (Flex -> Table) -->
        <div class="analysis-section" th:if="${tech != null}">
            <div class="analysis-title">âš™ï¸ æŠ€æœ¯å¯è¡Œæ€§ä¸ç”Ÿäº§æˆæœ¬</div>
            <table class="metric-table" th:if="${tech['manufacturingComplexity'] != null}">
                <tr>
                    <td class="metric-td metric-label">åˆ¶é€ å¤æ‚åº¦</td>
                    <td class="metric-td metric-value" th:text="${tech['manufacturingComplexity']}"></td>
                </tr>
            </table>
            <table class="metric-table" th:if="${tech['minOrderQuantity'] != null}">
                <tr>
                    <td class="metric-td metric-label">æœ€å°èµ·è®¢é‡</td>
                    <td class="metric-td metric-value" th:text="${tech['minOrderQuantity']}"></td>
                </tr>
            </table>
            <table class="metric-table" th:if="${tech['leadTime'] != null}">
                <tr>
                    <td class="metric-td metric-label">é¢„è®¡äº¤æœŸ</td>
                    <td class="metric-td metric-value" th:text="${tech['leadTime']}"></td>
                </tr>
            </table>
        </div>

        <!-- é£é™©è¯„ä¼° -->
        <div class="analysis-section" th:if="${risk != null}">
            <div class="analysis-title">âš ï¸ é£é™©è¯„ä¼°ä¸é™åˆ¶è¯´æ˜</div>
            
            <div class="risk-section" th:if="${materialRisksList != null and !materialRisksList.isEmpty()}">
                <div class="risk-title">æè´¨é£é™©</div>
                <div class="risk-content" th:text="${#strings.listJoin(materialRisksList, ', ')}"></div>
            </div>

            <div class="risk-section" th:if="${electronicRisksList != null and !electronicRisksList.isEmpty()}">
                <div class="risk-title">ç”µå­å…ƒä»¶é£é™©</div>
                <div class="risk-content" th:text="${#strings.listJoin(electronicRisksList, ', ')}"></div>
            </div>

            <table class="metric-table" th:if="${risk['warrantyPeriod'] != null}">
                <tr>
                    <td class="metric-td metric-label">å»ºè®®è´¨ä¿æœŸ</td>
                    <td class="metric-td metric-value" th:text="${risk['warrantyPeriod']} + 'ä¸ªæœˆ'"></td>
                </tr>
            </table>
        </div>

        <div class="footer">
            <p>Generated by <span class="brand">Heritage Culture</span> AI Design Platform</p>
            <p>Â© 2026 Heritage Culture. All rights reserved.</p>
        </div>
    </div>
</body>
</html>
